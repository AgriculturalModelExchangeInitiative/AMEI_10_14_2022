#'Test generation'

from stemp_epic import *
from math import *
import numpy 



def test_test1():
    params= stemp_epic(
    NL = 20,
    ISWWAT = "Y",
    DLAYR = [10.0, 10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0,10.0],
    BD = [1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6,1.6] ,
    DS = [10,20,30,40, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    DUL = [0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3],
    LL = [0.2, 0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2],
    NLAYR = 4,
    SW = [0.2, 0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2],
    TAMP = 10.0,
    RAIN = 0.0,
    TAVG = 25.0,
    TMAX = 30.0,
    TMIN = 20.0,
    TAV = 20.0,
    DEPIR = 0.0,
    BIOMAS = 0.0,
    MULCHMASS = 0.0,
    SNOW = 0.0,
     )
    SRFTEMP_estimated = round(params[0], 1)
    SRFTEMP_computed = 27.3
    assert (SRFTEMP_estimated == SRFTEMP_computed)
    ST_estimated = np.around(params[4], 1)
    ST_computed = [25.7,23.2,21.7,20.9, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]
    assert np.all(ST_estimated == ST_computed)